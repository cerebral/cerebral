import { createReturnPromise } from '../helpers'
import { convertObjectWithTemplates } from 'cerebral/tags'

function taskFactory(taskName, payload = {}) {
  function task({ firebase, path, resolve }) {
    return createReturnPromise(
      firebase.task(
        resolve.value(taskName),
        convertObjectWithTemplates(payload, resolve, 'firebase.task')
      ),
      path
    )
  }

  return task
}

export default taskFactory
