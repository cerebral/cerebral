# Angular 2/4 (BETA)

[Angular](https://angular.io/) view for Cerebral.

## Install

`npm install @cerebral/angular @angular/core @angular/platform-browser babel-plugin-transform-decorators-legacy`


```js
import { NgModule } from '@angular/core'
import { BrowserModule } from '@angular/platform-browser'
import { CerebralService } from '@cerebral/angular'
import { AppComponent }  from './app.component.ts'
import { SomeAngularService } from './some-service' //some angular service provider

const cerebralInitialStore = {
  state: {
    myName: 'Momo',
  }
}

// AOT support
export function startCerebral(someService: SomeAngularService) {
  
  function ServiceProvider(context) {
      context.someService = {
        sayHello: someService.hello,
        sayBye: someService.bye
      }
  
      if (context.debugger) {
        context.debugger.wrapProvider('someService')
      }
      return context
    }
  
  cerebralStore.providers = [
    ServiceProvider
  ]
})
@NgModule({
  imports:      [ BrowserModule ],
  declarations: [ AppComponent ],
  bootstrap:    [ AppComponent ],
  providers: [
     {
      provide: CerebralService,
      useFactory: startCerebral,
      deps: [SomeAngularService]
    },
  ]
})
export class AppModule {}
```

```js
import { ChangeDetectorRef, Component } from '@angular/core'
import { signal, state } from 'myapp'  // note above
import { Cerebral, CerebralService } from '@cerebral/angular'

@Component({ 
  selector: 'app-component',
  template: `
    <div (click)="onClick()">{{foo}}</div>
  `,
  changeDetection: ChangeDetectionStrategy.OnPush // disable angular change detection
})
@Cerebral({
  myName: state(['foo']), // notice array instead of template string literals to allow AOT
  onClick: signal(['mySignal'])
})
export class AppComponent {
  constructor(private ref: ChangeDetectorRef, private cerebral: CerebralService) { // needed by the decorator to trigger change detection
    // In some cases you might need access to cerebral's controller.
    this.cerebral.controller.getSignal('onClick')()
    
    // Optionally add custom behaviour to controller
  }
}
```

You can use cerebral controller anywhere in your app like in services/providers.
By importing CerebralServiceInstance from app.module.ts like this.
```js
import { CerebralService } from 'cerebral/@angular'
CerebralService.controller.getSignal('onClick')()
```

## TypeScript

```ts 
// special types for angular somewhere in myapp used below in your component/services file
// by doing this Angular and typescript will not complain about string literals compatibility for AOT
import { signal as originalSignal, state as originalState, Tag } from 'cerebral/tags'

interface CerebralAngularSignal {
  (path: any[], ...values: any[]): Tag
}

interface CerebralAngularState {
  (path: any[], ...values: any[]): Tag
}

export const signal = <CerebralAngularSignal> <any> originalSignal
export const state = <CerebralAngularState> <any> originalState
```
