/* eslint-env mocha */
import assert from 'assert'
import { extractValueWithPath, resolveObject } from './ResolveValue'
import Resolve from './providers/Resolve'
import { props } from './tags'

const provider = Resolve

describe('extractValueWithPath', () => {
  it('should resolve templates in object', () => {
    const obj = { foo: { bar: 'bar', baz: { bong: 'bing' } } }
    assert.strictEqual(extractValueWithPath(obj, 'foo.bar'), 'bar')
    assert.strictEqual(extractValueWithPath(obj, 'foo.baz.bong'), 'bing')
  })
})

describe('resolveObject', () => {
  it('should resolve templates in object on resolve', () => {
    const obj = resolveObject({ foo: props`foo` })
    const context = { props: { foo: 'bar' } }
    context.resolve = provider.get(context)
    assert.strictDeepEqual(context.resolve.value(obj), { foo: 'bar' })
  })
})
