/**
 * UniversalController type definiton test
 */
import { UniversalController, Module } from 'cerebral'

const appModule = Module({
  state: {
    foo: 0,
    isAwesome: false,
  },
  signals: {
    aSignal: [],
  },
})

const controller = UniversalController(appModule)

// runSequence
controller
  .runSequence(
    [
      function myAction({ state, props }: any) {
        state.set('app.isAwesome', props.isAwesome)
      },
    ],
    {
      isAwesome: true,
    }
  )
  .then(() => {
    // I am done running
  })

controller.runSequence('app.aSignal', { isAwesome: true }).then(() => {
  // I am done running
})

// setState
controller.setState('app.foo', 123)

// getChanges
controller.runSequence('app.aSignal', { isAwesome: true }).then(() => {
  controller.getChanges() // {"app.isAwesome": true}
})

// getScript

controller
  .run(
    [
      function myAction({ state, props }: any) {
        state.set('app.isAwesome', props.isAwesome)
      },
    ],
    {
      isAwesome: true,
    }
  )
  .then(() => {
    controller.getScript()
  })
