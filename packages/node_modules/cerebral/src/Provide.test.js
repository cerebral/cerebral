/* eslint-env mocha */
import Controller from './Controller'
import provide from './Provide'
import assert from 'assert'

describe('Provide', () => {
  it('should create a provider', done => {
    const controller = new Controller({
      providers: [provide('test', { foo: 'bar' })],
      signals: {
        test: [
          ({ test }) => {
            assert.deepEqual(test, { foo: 'bar' })
            done()
          },
        ],
      },
    })
    controller.getSignal('test')()
  })
  it('should allow function passed the context', done => {
    const controller = new Controller({
      providers: [
        provide('test', context => ({ controller: context.controller })),
      ],
      signals: {
        test: [
          ({ test, controller }) => {
            assert.equal(test.controller, controller)
            done()
          },
        ],
      },
    })
    controller.getSignal('test')()
  })
})
