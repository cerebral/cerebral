import * as React from 'react'
import { render } from 'react-dom'
import { Controller } from 'cerebral'
import { default as Devtools } from 'cerebral/devtools'
import { set } from 'cerebral/operators'
import { Container } from 'cerebral/react'
import { props, signal, state } from 'cerebral/tags'
import { default as Router } from '@cerebral/router'

declare var process: any

const router = Router({
  routes: [
    { path: '/', signal: 'foo' }
  ],
  query: true,
  onlyHash: true
})

const controller = Controller({
  state: {
    app: { name: 'Cerebral' }
  },
  modules: {
    foo: { state: { bar: 'bar' },
      signals: {
        foo: [set(state`bar`, props`foo`)]
      }
    }
  },
  devtools: process.env.NODE_ENV === 'production'
    ? undefined
    : Devtools({
      host: 'localhost:8585',
      reconnect: true
    })
})

render(
  React.createElement(
    Container,
    { controller }, 
    React.createElement('div', null, 'Hello Cerebral')
  ),
  document.querySelector('#app')
)
